<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FlipHawk | Smart Arbitrage Scanner</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root {
      --primary: #2563eb;
      --primary-dark: #1d4ed8;
      --primary-light: #dbeafe;
      --secondary: #10b981;
      --secondary-dark: #059669;
      --secondary-light: #d1fae5;
      --accent: #f59e0b;
      --background: #f8fafc;
      --surface: #ffffff;
      --text: #0f172a;
      --text-light: #64748b;
      --border: #e2e8f0;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--background);
      color: var(--text);
      line-height: 1.6;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      padding: 60px 0;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      opacity: 0.1;
    }

    .header h1 {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 3.5rem;
      margin-bottom: 1rem;
      position: relative;
    }

    .header p {
      font-size: 1.25rem;
      opacity: 0.9;
      max-width: 600px;
      margin: 0 auto;
      position: relative;
    }

    .main-card {
      background: var(--surface);
      border-radius: 16px;
      box-shadow: var(--shadow-lg);
      padding: 2rem;
      margin: -40px auto 40px;
      position: relative;
      max-width: 800px;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--text);
    }

    select {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 2px solid var(--border);
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background-color: var(--surface);
      cursor: pointer;
    }

    select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px var(--primary-light);
    }

    .subcategories {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }

    .checkbox-wrapper {
      display: flex;
      align-items: center;
      padding: 0.75rem;
      background: var(--background);
      border-radius: 8px;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .checkbox-wrapper:hover {
      background: var(--primary-light);
    }

    .checkbox-wrapper input[type="checkbox"] {
      margin-right: 0.75rem;
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 1rem 2rem;
      font-size: 1rem;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .btn-primary:disabled {
      background: var(--text-light);
      cursor: not-allowed;
      transform: none;
    }

    .btn i {
      margin-right: 0.5rem;
    }

    .loading {
      text-align: center;
      padding: 3rem;
    }

    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 4px solid var(--primary-light);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .error {
      background: #fee2e2;
      color: #dc2626;
      padding: 1rem;
      border-radius: 8px;
      margin: 1rem 0;
      display: flex;
      align-items: center;
    }

    .error i {
      margin-right: 0.75rem;
    }

    .results {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }

    .result-card {
      background: var(--surface);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
    }

    .result-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }

    .result-header {
      padding: 1.5rem;
      border-bottom: 1px solid var(--border);
    }

    .result-header h3 {
      font-size: 1.125rem;
      margin-bottom: 0.5rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .confidence-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.875rem;
      font-weight: 600;
      color: white;
    }

    .confidence-high { background: var(--secondary); }
    .confidence-medium { background: var(--accent); }
    .confidence-low { background: #ef4444; }

    .result-body {
      padding: 1.5rem;
    }

    .price-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1rem;
    }

    .price-item {
      text-align: center;
    }

    .price-label {
      font-size: 0.875rem;
      color: var(--text-light);
      margin-bottom: 0.25rem;
    }

    .price-value {
      font-size: 1.25rem;
      font-weight: 700;
    }

    .profit-section {
      background: var(--secondary-light);
      padding: 1rem;
      border-radius: 8px;
      text-align: center;
      margin-bottom: 1rem;
    }

    .profit-label {
      font-size: 0.875rem;
      color: var(--secondary-dark);
      margin-bottom: 0.25rem;
    }

    .profit-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--secondary-dark);
    }

    .result-actions {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    .result-link {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.75rem;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .buy-link {
      background: var(--primary);
      color: white;
    }

    .sell-link {
      background: var(--secondary);
      color: white;
    }

    .result-link:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }

    .stats-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .stat-card {
      background: var(--surface);
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: var(--shadow);
      text-align: center;
    }

    .stat-icon {
      font-size: 2rem;
      color: var(--primary);
      margin-bottom: 1rem;
    }

    .stat-value {
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .stat-label {
      color: var(--text-light);
      font-size: 0.875rem;
    }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 2.5rem;
      }
      
      .main-card {
        margin: -20px 20px 20px;
        padding: 1.5rem;
      }
      
      .subcategories {
        grid-template-columns: 1fr;
      }
      
      .results {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="container">
      <h1>FlipHawk</h1>
      <p>Discover profitable arbitrage opportunities across online marketplaces with advanced AI-powered scanning</p>
    </div>
  </header>

  <main class="container">
    <div class="main-card">
      <div class="form-group">
        <label for="category">Select Category</label>
        <select id="category">
          <option value="">Choose a category...</option>
          <option value="Tech">Tech</option>
          <option value="Collectibles">Collectibles</option>
          <option value="Vintage Clothing">Vintage Clothing</option>
          <option value="Antiques">Antiques</option>
          <option value="Gaming">Gaming</option>
          <option value="Music Gear">Music Gear</option>
          <option value="Tools & DIY">Tools & DIY</option>
          <option value="Outdoors & Sports">Outdoors & Sports</option>
        </select>
      </div>

      <div id="subcategoriesContainer" style="display: none;">
        <label>Select Subcategories (up to 5)</label>
        <div class="subcategories" id="subcategories"></div>
      </div>

      <button id="scanButton" class="btn btn-primary" disabled>
        <i class="fas fa-search"></i> Find Opportunities
      </button>

      <div id="error" class="error" style="display: none;">
        <i class="fas fa-exclamation-circle"></i>
        <span></span>
      </div>

      <div id="loading" class="loading" style="display: none;">
        <div class="loading-spinner"></div>
        <p>Scanning for opportunities...</p>
      </div>
    </div>

    <div id="results" class="results"></div>
  </main>

  <script>
    // Categories data
    const categories = {
      "Tech": ["Headphones", "Keyboards", "Graphics Cards", "CPUs", "Laptops", "Monitors", "SSDs", "Routers", "Vintage Tech"],
      "Collectibles": ["PokÃ©mon", "Magic: The Gathering", "Yu-Gi-Oh", "Funko Pops", "Sports Cards", "Comic Books", "Action Figures", "LEGO Sets"],
      "Vintage Clothing": ["Jordans", "Nike Dunks", "Vintage Tees", "Band Tees", "Denim Jackets", "Designer Brands", "Carhartt", "Patagonia"],
      "Antiques": ["Coins", "Watches", "Cameras", "Typewriters", "Vinyl Records", "Vintage Tools", "Old Maps", "Antique Toys"],
      "Gaming": ["Consoles", "Game Controllers", "Rare Games", "Arcade Machines", "Handhelds", "Gaming Headsets", "VR Gear"],
      "Music Gear": ["Electric Guitars", "Guitar Pedals", "Synthesizers", "Vintage Amps", "Microphones", "DJ Equipment"],
      "Tools & DIY": ["Power Tools", "Hand Tools", "Welding Equipment", "Toolboxes", "Measuring Devices", "Woodworking Tools"],
      "Outdoors & Sports": ["Bikes", "Skateboards", "Scooters", "Camping Gear", "Hiking Gear", "Fishing Gear", "Snowboards"]
    };

    const categorySelect = document.getElementById('category');
    const subcategoriesContainer = document.getElementById('subcategoriesContainer');
    const subcategoriesDiv = document.getElementById('subcategories');
    const scanButton = document.getElementById('scanButton');
    const errorDiv = document.getElementById('error');
    const loadingDiv = document.getElementById('loading');
    const resultsDiv = document.getElementById('results');
    
    let selectedSubcategories = [];

    categorySelect.addEventListener('change', function() {
      const category = this.value;
      selectedSubcategories = [];
      
      if (category) {
        subcategoriesContainer.style.display = 'block';
        const subcats = categories[category];
        let html = '';
        subcats.forEach(subcat => {
          html += `
            <label class="checkbox-wrapper">
              <input type="checkbox" value="${subcat}" onchange="handleSubcategoryChange(this)">
              ${subcat}
            </label>
          `;
        });
        subcategoriesDiv.innerHTML = html;
      } else {
        subcategoriesContainer.style.display = 'none';
        subcategoriesDiv.innerHTML = '';
      }
      
      updateScanButton();
    });

    function handleSubcategoryChange(checkbox) {
      if (checkbox.checked) {
        if (selectedSubcategories.length < 5) {
          selectedSubcategories.push(checkbox.value);
        } else {
          checkbox.checked = false;
          showError('You can only select up to 5 subcategories');
        }
      } else {
        selectedSubcategories = selectedSubcategories.filter(item => item !== checkbox.value);
      }
      
      updateScanButton();
    }

    function updateScanButton() {
      scanButton.disabled = !(categorySelect.value && selectedSubcategories.length > 0);
    }

    function showError(message) {
      errorDiv.querySelector('span').textContent = message;
      errorDiv.style.display = 'flex';
      setTimeout(() => {
        errorDiv.style.display = 'none';
      }, 5000);
    }

    scanButton.addEventListener('click', async function() {
      errorDiv.style.display = 'none';
      loadingDiv.style.display = 'block';
      resultsDiv.innerHTML = '';
      scanButton.disabled = true;
      
      try {
        const response = await fetch('/api/v1/scan', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            category: categorySelect.value,
            subcategories: selectedSubcategories
          })
        });
        
        if (!response.ok) {
          throw new Error('Scan failed');
        }
        
        const data = await response.json();
        displayResults(data);
        
      } catch (error) {
        showError('Failed to run scan. Please try again.');
      } finally {
        loadingDiv.style.display = 'none';
        updateScanButton();
      }
    });

    function getConfidenceBadgeClass(confidence) {
      if (confidence >= 90) return 'confidence-high';
      if (confidence >= 70) return 'confidence-medium';
      return 'confidence-low';
    }

    function displayResults(results) {
      if (results.length === 0) {
        resultsDiv.innerHTML = `
          <div style="text-align: center; padding: 3rem;">
            <i class="fas fa-search" style="font-size: 3rem; color: var(--text-light); margin-bottom: 1rem;"></i>
            <h3>No opportunities found</h3>
            <p style="color: var(--text-light);">Try selecting different subcategories or check back later</p>
          </div>
        `;
        return;
      }
      
      const html = results.map(result => `
        <div class="result-card">
          <div class="result-header">
            <h3>${result.title}</h3>
            <span class="confidence-badge ${getConfidenceBadgeClass(result.confidence)}">
              ${result.confidence}% Match
            </span>
          </div>
          <div class="result-body">
            <div class="price-row">
              <div class="price-item">
                <div class="price-label">Buy Price</div>
                <div class="price-value">$${result.buyPrice.toFixed(2)}</div>
              </div>
              <div class="price-item">
                <div class="price-label">Sell Price</div>
                <div class="price-value">$${result.sellPrice.toFixed(2)}</div>
              </div>
            </div>
            <div class="profit-section">
              <div class="profit-label">Potential Profit</div>
              <div class="profit-value">$${result.profit.toFixed(2)} (${result.profitPercentage.toFixed(1)}%)</div>
            </div>
            <div class="result-actions">
              <a href="${result.buyLink}" target="_blank" class="result-link buy-link">
                <i class="fas fa-shopping-cart"></i> Buy
              </a>
              <a href="${result.sellLink}" target="_blank" class="result-link sell-link">
                <i class="fas fa-store"></i> Sell
              </a>
            </div>
          </div>
        </div>
      `).join('');
      
      resultsDiv.innerHTML = html;
    }
  </script>
</body>
</html>
